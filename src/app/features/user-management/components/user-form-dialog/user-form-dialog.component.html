<h2 mat-dialog-title>{{ isEditMode() ? 'Edit Staff' : 'Add New Staff' }}</h2>

<mat-dialog-content>
    <form [formGroup]="userForm" class="user-form">
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Display Name</mat-label>
            <input matInput formControlName="displayName" placeholder="John Doe">
            <mat-error *ngIf="userForm.get('displayName')?.hasError('required')">
                Display Name is required
            </mat-error>
        </mat-form-field>

        <div class="row">
            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" type="email" placeholder="john@example.com">
                <mat-error *ngIf="userForm.get('email')?.hasError('required')">
                    Email is required
                </mat-error>
                <mat-error *ngIf="userForm.get('email')?.hasError('email')">
                    Invalid email address
                </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Phone</mat-label>
                <input matInput formControlName="phone" type="tel" placeholder="+1234567890">
                <mat-error *ngIf="userForm.get('phone')?.hasError('required')">
                    Phone is required
                </mat-error>
            </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Password</mat-label>
            <input matInput formControlName="password" type="password"
                [placeholder]="isEditMode() ? 'Leave blank to keep current' : ''">
            <mat-error *ngIf="userForm.get('password')?.hasError('required')">
                Password is required
            </mat-error>
            <mat-error *ngIf="userForm.get('password')?.hasError('minlength')">
                Password must be at least 6 characters
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Roles</mat-label>
            <mat-select formControlName="roles" multiple>
                @for (role of rolesList; track role) {
                <mat-option [value]="role">{{ role }}</mat-option>
                }
            </mat-select>
            <mat-error *ngIf="userForm.get('roles')?.hasError('required')">
                At least one role is required
            </mat-error>
        </mat-form-field>

    </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()" [disabled]="isSubmitting()">Cancel</button>
    <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="userForm.invalid || isSubmitting()">
        @if (isSubmitting()) {
        <div class="spinner-container">
            <mat-spinner diameter="20"></mat-spinner>
        </div>
        } @else {
        {{ isEditMode() ? 'Save Changes' : 'Create Account' }}
        }
    </button>
</mat-dialog-actions>